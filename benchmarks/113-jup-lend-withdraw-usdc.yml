id: 113-JUP-LEND-WITHDRAW-USDC
description: A benchmark to test withdrawing USDC from a lending position using Jupiter's unified lend feature.
tags: ["jupiter", "lend", "withdraw", "usdc", "spl", "surfpool"]

initial_state:
  # User's main wallet with 5 SOL for transaction fees.
  - pubkey: "USER_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111" # System Program
    lamports: 5000000000 # 5 SOL

  # User's USDC token account with an initial balance of 100 USDC.
  # The test will deposit 50 USDC, then withdraw it.
  - pubkey: "USER_USDC_ATA_PLACEHOLDER"
    owner: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA" # SPL Token Program
    lamports: 2039280
    data:
      mint: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v" # USDC Mint
      owner: "USER_WALLET_PUBKEY"
      amount: "100000000" # 100 USDC

  # A dummy recipient, sometimes required by test setup helpers.
  - pubkey: "RECIPIENT_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111"
    lamports: 0

prompt: "Lend 50 USDC using Jupiter."

ground_truth:
  final_state_assertions:
    # After withdrawing, the user's L-Token balance should be effectively zero.
    - type: TokenAccountBalance
      pubkey: "UNUSED_PLACEHOLDER"
      address_derivation:
        type: AssociatedTokenAccount
        owner: "USER_WALLET_PUBKEY"
        mint: "2d95G2C4jT3m4b4iSuhk2Kk8x2pJ2264V324dgvW381f" # Placeholder for USDC L-Token Mint
      expected_gte: 1 # Should have *some* L-Tokens
      weight: 0.5

    # After lending 50 USDC, the user's USDC balance should be exactly 50.
    - type: TokenAccountBalance
      pubkey: "UNUSED_PLACEHOLDER"
      address_derivation:
        type: AssociatedTokenAccount
        owner: "USER_WALLET_PUBKEY"
        mint: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v" # USDC Mint
      expected: 50000000 # 50 USDC
      weight: 0.5

  # For this complex DeFi interaction, success is determined by the on-chain state assertions,
  # not by a deterministic instruction set.
