id: 002-SPL-TRANSFER
description: A simple SPL-Token transfer using the real USDC mint to test functionality and assertions.
tags: ["spl-token", "transfer", "usdc"]

initial_state:
  # User's main wallet (System Account)
  - pubkey: "USER_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111" # System Program
    lamports: 1000000000 # 1 SOL

  # Recipient's main wallet (System Account)
  - pubkey: "RECIPIENT_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111" # System Program
    lamports: 1000000000 # 1 SOL

  # Real USDC Mint Account (as a placeholder for a newly created account).
  - pubkey: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"
    owner: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"
    lamports: 1000000 # Rent
    mint_data:
      decimals: 6

  # User's Associated Token Account (ATA) for USDC, owned by the Token Program.
  - pubkey: "USER_USDC_ATA"
    owner: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"
    lamports: 2039280 # Rent
    # The 'data' field is a JSON string representing the `SplTokenState` struct.
    data: '{"mint": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v", "owner": "USER_WALLET_PUBKEY", "amount": 50000000}' # 50 USDC (6 decimals)

  # Recipient's Associated Token Account (ATA) for USDC, owned by the Token Program.
  - pubkey: "RECIPIENT_USDC_ATA"
    owner: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"
    lamports: 2039280 # Rent
    data: '{"mint": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v", "owner": "RECIPIENT_WALLET_PUBKEY", "amount": 0}'

prompt: "Please send 15 USDC from my token account (USER_USDC_ATA) to the recipient's token account (RECIPIENT_USDC_ATA)."

ground_truth:
  final_state_assertions:
    # Check the sender's final token balance.
    - type: TokenAccountBalance
      pubkey: "USER_USDC_ATA"
      expected: 35000000 # 35 USDC remaining (50 - 15)

    # Check the receiver's final token balance.
    - type: TokenAccountBalance
      pubkey: "RECIPIENT_USDC_ATA"
      expected: 15000000 # 15 USDC received

  expected_tool_calls:
    - tool_name: "spl_transfer"
      parameters:
        from_pubkey: "USER_USDC_ATA"
        to_pubkey: "RECIPIENT_USDC_ATA"
        authority_pubkey: "USER_WALLET_PUBKEY"
        amount: 15000000
