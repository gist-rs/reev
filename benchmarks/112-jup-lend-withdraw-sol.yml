id: 112-jup-lend-withdraw-sol
description: A benchmark to test withdrawing native SOL from a lending position using Jupiter's unified lend feature.
tags: ["jupiter", "lend", "withdraw", "sol", "surfpool"]

initial_state:
  # User's main wallet with 5 SOL for transaction fees.
  - pubkey: "USER_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111" # System Program
    lamports: 5000000000 # 5 SOL

  # User's L-SOL token account representing a previous deposit of 0.1 SOL.
  - pubkey: "USER_L_SOL_ATA_PLACEHOLDER"
    owner: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA" # SPL Token Program
    lamports: 2039280
    data:
      mint: "2uQsyo1fXXQkDtcpXnLofWy88PxcvnfH2L8FPSE62FVU" # L-SOL Mint
      owner: "USER_WALLET_PUBKEY"
      amount: "100000000" # 0.1 L-SOL

  # A dummy recipient, sometimes required by test setup helpers.
  - pubkey: "RECIPIENT_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111"
    lamports: 0

prompt: "Withdraw 0.1 SOL using Jupiter. My wallet is USER_WALLET_PUBKEY."

ground_truth:
  final_state_assertions:
    # After withdrawing 0.1 SOL, the user's L-SOL balance should be 0.
    - type: TokenAccountBalance
      pubkey: "UNUSED_PLACEHOLDER"
      address_derivation:
        type: AssociatedTokenAccount
        owner: "USER_WALLET_PUBKEY"
        mint: "2uQsyo1fXXQkDtcpXnLofWy88PxcvnfH2L8FPSE62FVU" # L-SOL Mint
      expected: 0
      weight: 0.5

    # The user's SOL balance should increase by ~0.1 SOL.
    - type: SolBalanceChange
      pubkey: "USER_WALLET_PUBKEY"
      expected_change_gte: 95000000 # ~0.095 SOL (allowing for fees)
      weight: 0.5

  # For this complex DeFi interaction, success is determined by the on-chain state assertions.
