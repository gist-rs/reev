id: 001-SOL-TRANSFER
description: A simple SOL transfer from one wallet to another to test basic tool selection and parameterization.
tags: ["system-program", "transfer", "t2"]

# Defines the on-chain state at the beginning of the test.
# Placeholders like USER_WALLET_PUBKEY will be replaced by the test runner.
initial_state:
  - pubkey: "USER_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111" # System Program
    lamports: 1000000000 # 1 SOL

  - pubkey: "RECIPIENT_WALLET_PUBKEY"
    owner: "11111111111111111111111111111111" # System Program
    lamports: 0

# The natural language prompt given to the agent.
prompt: "Please send 0.1 SOL from my wallet (USER_WALLET_PUBKEY) to the recipient (RECIPIENT_WALLET_PUBKEY)."

# The objective criteria for judging the agent's performance.
ground_truth:
  # A list of on-chain conditions that must be true after the agent has finished.
  final_state_assertions:
    - type: SolBalance
      pubkey: "RECIPIENT_WALLET_PUBKEY"
      expected: 100000000 # 0.1 SOL

    # Note: Checking the sender's balance is tricky due to variable fees.
    # A more robust check would be 'balance_less_than' or 'balance_change_approx'.
    # For this simple case, we'll assume a fixed fee of 5000 lamports.
    - type: SolBalance
      pubkey: "USER_WALLET_PUBKEY"
      expected: 899995000 # 1 SOL - 0.1 SOL - 0.000005 SOL fee

  # The ideal sequence of tool calls the agent should make. This now reflects
  # a raw Solana instruction, which is what the agent is expected to generate.
  expected_tool_calls:
    - program_id: "11111111111111111111111111111111" # System Program
      accounts:
        - pubkey: "USER_WALLET_PUBKEY"
          is_signer: true
          is_writable: true
        - pubkey: "RECIPIENT_WALLET_PUBKEY"
          is_signer: false
          is_writable: true
      # Instruction data for a System Program transfer:
      # - 4 bytes: instruction index (2 for transfer)
      # - 8 bytes: lamports (0.1 SOL = 100,000,000 lamports)
      # This is base58 encoded.
      data: "2E4pS263t"
